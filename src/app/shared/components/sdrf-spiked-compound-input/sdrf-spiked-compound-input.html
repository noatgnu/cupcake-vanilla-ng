<form [formGroup]="spikedForm" class="spiked-compound-input-form">
  <div class="row g-3">
    
    <!-- Compound Type (CT) - Required -->
    <div class="col-md-6">
      <label for="CT" class="form-label">
        Compound Type <span class="text-danger">*</span>
        <small class="text-muted">(CT)</small>
      </label>
      <select class="form-select" id="CT" formControlName="CT"
              [class.is-invalid]="spikedForm.get('CT')?.invalid && spikedForm.get('CT')?.touched">
        <option value="">Select compound type...</option>
        @for (type of compoundTypes; track type) {
          <option [value]="type">{{ type }}</option>
        }
      </select>
      <div class="form-text">Type of spiked compound</div>
      <div class="invalid-feedback">
        Compound type is required
      </div>
    </div>

    <!-- Quantity (QY) - Required -->
    <div class="col-md-6">
      <label for="QY" class="form-label">
        Quantity <span class="text-danger">*</span>
        <small class="text-muted">(QY)</small>
      </label>
      <input 
        type="text" 
        class="form-control" 
        id="QY"
        formControlName="QY"
        placeholder="e.g., 10 fmol, 50 ng"
        [class.is-invalid]="spikedForm.get('QY')?.invalid && spikedForm.get('QY')?.touched">
      <div class="form-text">Quantity with units (molar or mass)</div>
      <div class="invalid-feedback">
        Quantity is required
      </div>
    </div>

    <!-- Species (SP) -->
    <div class="col-md-6">
      <label for="SP" class="form-label">
        Species <small class="text-muted">(SP)</small>
      </label>
      <input 
        type="text" 
        class="form-control" 
        id="SP"
        formControlName="SP"
        placeholder="e.g., homo sapiens">
      <div class="form-text">Species of origin</div>
    </div>

    <!-- Compound Name (CN) -->
    <div class="col-md-6">
      <label for="CN" class="form-label">
        Compound Name <small class="text-muted">(CN)</small>
      </label>
      <input 
        type="text" 
        class="form-control" 
        id="CN"
        formControlName="CN"
        placeholder="e.g., Myoglobin">
      <div class="form-text">Name of the compound</div>
    </div>

    <!-- Protein-specific fields -->
    @if (showProteinFields) {
      <div class="col-md-12">
        <label for="AC" class="form-label">
          Uniprot Accession <small class="text-muted">(AC)</small>
        </label>
        <input 
          type="text" 
          class="form-control" 
          id="AC"
          formControlName="AC"
          placeholder="e.g., P68871">
        <div class="form-text">Uniprot accession for protein compounds</div>
      </div>
    }

    <!-- Peptide-specific fields -->
    @if (showPeptideFields) {
      <div class="col-md-12">
        <label for="PS" class="form-label">
          Peptide Sequence <small class="text-muted">(PS)</small>
        </label>
        <input 
          type="text" 
          class="form-control" 
          id="PS"
          formControlName="PS"
          placeholder="e.g., PEPTIDESEQ">
        <div class="form-text">Peptide sequence for peptide compounds</div>
      </div>
    }

    <!-- Compound Vendor (CV) -->
    <div class="col-md-6">
      <label for="CV" class="form-label">
        Compound Vendor <small class="text-muted">(CV)</small>
      </label>
      <input 
        type="text" 
        class="form-control" 
        id="CV"
        formControlName="CV"
        placeholder="e.g., Sigma-Aldrich">
      <div class="form-text">Vendor or supplier name</div>
    </div>

    <!-- Compound Formula (CF) -->
    <div class="col-md-6">
      <label for="CF" class="form-label">
        Compound Formula <small class="text-muted">(CF)</small>
      </label>
      <input 
        type="text" 
        class="form-control" 
        id="CF"
        formControlName="CF"
        placeholder="e.g., C8H14N4O2">
      <div class="form-text">Chemical formula</div>
    </div>

    <!-- Compound Specification URI (CS) -->
    <div class="col-md-12">
      <label for="CS" class="form-label">
        Compound Specification URI <small class="text-muted">(CS)</small>
      </label>
      <input 
        type="url" 
        class="form-control" 
        id="CS"
        formControlName="CS"
        placeholder="https://example.com/compound-spec">
      <div class="form-text">URI to compound specification or documentation</div>
    </div>

  </div>

  <!-- Preview -->
  @if (spikedForm.valid && (spikedForm.get('CT')?.value && spikedForm.get('QY')?.value)) {
    <div class="mt-3 p-2 bg-body-secondary border rounded">
      <small class="text-muted fw-semibold">Preview:</small>
      <div class="font-monospace small">{{ value || 'Building...' }}</div>
    </div>
  }

  <!-- Validation Summary -->
  @if (spikedForm.invalid && spikedForm.touched) {
    <div class="alert alert-warning mt-3">
      <small>
        <i class="bi bi-exclamation-triangle me-1"></i>
        <strong>Required fields:</strong> Compound Type (CT) and Quantity (QY) must be filled.
      </small>
    </div>
  }
</form>
