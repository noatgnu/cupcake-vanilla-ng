<div class="modal-header">
  <h4 class="modal-title">
    @if (results?.success) {
      <i class="fa fa-check-circle me-2 text-success"></i>
      Validation Passed
    } @else {
      <i class="fa fa-exclamation-triangle me-2 text-danger"></i>
      Validation Failed
    }
  </h4>
  <button
    type="button"
    class="btn-close"
    aria-label="Close"
    (click)="activeModal.dismiss()">
  </button>
</div>

<div class="modal-body">
  @if (results) {
    <div class="mb-3">
      <h6 class="mb-2">
        <i class="fa fa-table me-2 text-primary"></i>
        {{ results.metadata_table_name }}
      </h6>
      <small class="text-muted">
        <i class="fa fa-clock me-1"></i>
        Validated: {{ formatTimestamp(results.validation_timestamp) }}
      </small>
    </div>

    @if (results.success) {
      <!-- Success message -->
      <div class="alert alert-success">
        <i class="fa fa-check-circle me-2"></i>
        <strong>Validation Successful!</strong>
        <p class="mb-0 mt-2">
          Your metadata table complies with SDRF format standards and contains no validation errors.
        </p>
      </div>
    } @else {
      <!-- Validation failed - show errors and warnings -->
      <div class="alert alert-danger mb-3">
        <i class="fa fa-exclamation-triangle me-2"></i>
        <strong>Validation Failed</strong>
        <p class="mb-0 mt-2">
          Your metadata table contains validation issues that need to be resolved.
        </p>
      </div>

      <!-- Summary -->
      <div class="row mb-3">
        <div class="col-md-6">
          <div class="card border-danger">
            <div class="card-body text-center">
              <h5 class="card-title text-danger">{{ results.errors.length }}</h5>
              <p class="card-text">Error{{ results.errors.length !== 1 ? 's' : '' }}</p>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card border-warning">
            <div class="card-body text-center">
              <h5 class="card-title text-warning">{{ results.warnings.length }}</h5>
              <p class="card-text">Warning{{ results.warnings.length !== 1 ? 's' : '' }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Errors -->
      @if (results.errors.length > 0) {
        <div class="mb-3">
          <h6 class="text-danger">
            <i class="fa fa-times-circle me-2"></i>
            Errors ({{ results.errors.length }})
          </h6>
          <div class="validation-issues">
            @for (error of results.errors; track $index) {
              <div class="alert alert-danger py-2 px-3">
                <i class="fa fa-times-circle me-2"></i>
                {{ error }}
              </div>
            }
          </div>
        </div>
      }

      <!-- Warnings -->
      @if (results.warnings.length > 0) {
        <div class="mb-3">
          <h6 class="text-warning">
            <i class="fa fa-exclamation-triangle me-2"></i>
            Warnings ({{ results.warnings.length }})
          </h6>
          <div class="validation-issues">
            @for (warning of results.warnings; track $index) {
              <div class="alert alert-warning py-2 px-3">
                <i class="fa fa-exclamation-triangle me-2"></i>
                {{ warning }}
              </div>
            }
          </div>
        </div>
      }

      <!-- Help text -->
      <div class="alert alert-info">
        <i class="fa fa-info-circle me-2"></i>
        <strong>Need Help?</strong>
        <ul class="mb-0 mt-2">
          <li>Errors must be fixed before your metadata can be exported as valid SDRF</li>
          <li>Warnings indicate potential issues but don't prevent SDRF export or validation</li>
          <li>Check the <a href="https://sdrf.quantms.org" target="_blank">SDRF Specification</a> for detailed explanations of column and their requirements</li>
        </ul>
      </div>
    }
  }
</div>

<div class="modal-footer">
  <button
    type="button"
    class="btn btn-secondary"
    (click)="activeModal.dismiss()">
    Close
  </button>
</div>
